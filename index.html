<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>La vuelta al mundo con Plex</title>

<!-- Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #f2f2f2;
}

h1 {
  text-align: center;
  margin: 10px 0;
}

#map {
  height: 80vh;
  width: 100%;
}

.panel {
  background: white;
  padding: 10px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
}

.counter {
  font-size: 18px;
  font-weight: bold;
}

.counter input {
  width: 100px;
  font-size: 16px;
}

.legend {
  font-size: 14px;
}

/* ICONO DE LA CLASE */
.school-icon {
  background: #fff176;
  color: #1a237e;
  padding: 6px 10px;
  border-radius: 10px;
  border: 2px solid #1a237e;
  font-weight: bold;
  white-space: nowrap;
  box-shadow: 0 2px 6px rgba(0,0,0,0.3);
}
</style>
</head>

<body>

<h1>ğŸŒ La vuelta al mundo con Plex</h1>

<div class="panel">
<div id="paisActual" style="font-weight:bold; color:#1a237e;">
  PaÃ­s actual: â€”
</div>

  <div class="counter">
    Km acumulados:
    <input type="number" id="kmInput" value="0" min="0" max="5000"> / 5000 km
  </div>

<button id="actualizarBtn" style="
  margin-left:10px;
  padding:6px 12px;
  font-size:14px;
  cursor:pointer;
">
  ğŸš€ Viajar
</button>

  <div class="legend">
    ğŸ”µ Ruta del viaje<br>
    ğŸ“ EducaciÃ³n FÃ­sica con 6Âº
  </div>
</div>

<div id="map"></div>

<div id="notificaciones" style="
  background:white;
  padding:10px;
  margin:10px;
  border-left:6px solid #1a237e;
  font-size:16px;
">
  <strong>ğŸ“¢ Dato del paÃ­s:</strong>
  <div id="datoPais">Introduce km para comenzar el viaje ğŸŒ</div>
</div>


<script>
/* =========================
   1. MAPA BASE
========================= */
const map = L.map("map").setView([20, 0], 2);

L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
  attribution: "Â© OpenStreetMap"
}).addTo(map);

/* =========================
   2. PAÃSES DEL RECORRIDO
   (ORDEN + KM = 5000)
========================= */
const routeData = [
  { etapa:1, pais:"EspaÃ±a", km:250, coords:[40.4,-3.7] },
  { etapa:2, pais:"Francia", km:200, coords:[46.2,2.2] },
  { etapa:3, pais:"Italia", km:200, coords:[42.8,12.5] },
  { etapa:4, pais:"Grecia", km:150, coords:[39,22] },
  { etapa:5, pais:"Egipto", km:250, coords:[26.8,30.8] },
  { etapa:6, pais:"SudÃ¡frica", km:350, coords:[-30.6,22.9] },
  { etapa:7, pais:"Brasil", km:400, coords:[-14.2,-51.9] },
  { etapa:8, pais:"Argentina", km:350, coords:[-38.4,-63.6] },
  { etapa:9, pais:"Estados Unidos", km:500, coords:[39.8,-98.6] },
  { etapa:10, pais:"MÃ©xico", km:300, coords:[23.6,-102.5] },
  { etapa:11, pais:"JapÃ³n", km:250, coords:[36.2,138.2] },
  { etapa:12, pais:"China", km:450, coords:[35.9,104.2] },
  { etapa:13, pais:"India", km:350, coords:[22.9,78.9] },
  { etapa:14, pais:"Australia", km:300, coords:[-25.3,133.8] },
  { etapa:15, pais:"Rusia", km:500, coords:[61.5,105.3] }
];

const countryContent = {
  "EspaÃ±a": [
    "El fÃºtbol es el deporte mÃ¡s practicado en EspaÃ±a.",
    "EspaÃ±a ha ganado Copas del Mundo y Eurocopas.",
    "El baloncesto espaÃ±ol es referente internacional.",
    "Las deportistas espaÃ±olas destacan a nivel mundial.",
    "El deporte escolar fomenta hÃ¡bitos saludables.",
    "EspaÃ±a tiene deportes tradicionales como la pelota.",
    "La actividad fÃ­sica mejora la salud mental.",
    "El clima favorece el deporte al aire libre.",
    "El deporte promueve la convivencia.",
    "La EducaciÃ³n FÃ­sica es clave en Primaria.",
    "EspaÃ±a destaca en deportes de equipo.",
    "El deporte ayuda a la inclusiÃ³n social.",
    "La expresiÃ³n corporal se trabaja en EF.",
    "El movimiento mejora la concentraciÃ³n.",
    "El juego cooperativo es fundamental.",
    "El deporte reduce el estrÃ©s.",
    "La igualdad de gÃ©nero es prioritaria en el deporte.",
    "Los Juegos OlÃ­mpicos inspiran a los jÃ³venes.",
    "El deporte fomenta valores.",
    "La EF mejora la autoestima."
  ],

  "Francia": [
    "Francia es cuna de los Juegos OlÃ­mpicos modernos.",
    "El Tour de Francia es una prueba mundial.",
    "El deporte escolar es muy importante.",
    "El atletismo tiene gran tradiciÃ³n.",
    "El balonmano francÃ©s es referente.",
    "El deporte fomenta hÃ¡bitos saludables.",
    "Las deportistas francesas son referentes.",
    "El deporte une culturas.",
    "La actividad fÃ­sica mejora la salud.",
    "El juego limpio es un valor clave.",
    "El rugby es muy popular.",
    "El deporte promueve el respeto.",
    "El trabajo en equipo es esencial.",
    "La EF mejora la coordinaciÃ³n.",
    "El deporte es cultura.",
    "La danza forma parte de la EF.",
    "El deporte favorece la igualdad.",
    "El esfuerzo es un valor educativo.",
    "La cooperaciÃ³n es fundamental.",
    "El deporte mejora la convivencia."
  ],

  "Italia": [
    "El fÃºtbol es el deporte mÃ¡s popular en Italia.",
    "Italia destaca en ciclismo y motor.",
    "El deporte forma parte de su cultura.",
    "La danza es muy expresiva.",
    "El movimiento mejora la salud.",
    "El deporte fomenta disciplina.",
    "Las deportistas italianas son referentes.",
    "El juego es aprendizaje.",
    "La EF desarrolla habilidades motrices.",
    "El deporte une generaciones.",
    "La expresiÃ³n corporal es importante.",
    "El trabajo cooperativo es esencial.",
    "El deporte favorece la inclusiÃ³n.",
    "El respeto es un valor bÃ¡sico.",
    "El deporte mejora la autoestima.",
    "El esfuerzo se valora.",
    "El deporte enseÃ±a normas.",
    "La actividad fÃ­sica es salud.",
    "El deporte educa en valores.",
    "El juego fomenta la socializaciÃ³n."
  ],

  "Grecia": [
    "Grecia es el origen de los Juegos OlÃ­mpicos.",
    "El deporte estaba ligado a la educaciÃ³n.",
    "El cuerpo era parte del aprendizaje.",
    "La actividad fÃ­sica era esencial.",
    "El atletismo naciÃ³ en Grecia.",
    "El deporte fomentaba valores.",
    "La EF une cuerpo y mente.",
    "El movimiento mejora la salud.",
    "El deporte enseÃ±a respeto.",
    "La cooperaciÃ³n era importante.",
    "El juego era educativo.",
    "El esfuerzo era valorado.",
    "El deporte unÃ­a a la sociedad.",
    "La disciplina era fundamental.",
    "El cuerpo era cultura.",
    "La actividad fÃ­sica era diaria.",
    "El deporte fomentaba la paz.",
    "La igualdad era valorada.",
    "El juego era aprendizaje.",
    "El deporte formaba ciudadanos."
  ],

  "Egipto": [
    "En Egipto se practicaban juegos fÃ­sicos.",
    "La danza tenÃ­a valor cultural.",
    "El movimiento estaba en rituales.",
    "La actividad fÃ­sica era cotidiana.",
    "Los juegos fortalecÃ­an el cuerpo.",
    "El deporte tenÃ­a valor social.",
    "La EF desarrolla coordinaciÃ³n.",
    "El movimiento mejora la salud.",
    "El cuerpo era expresiÃ³n.",
    "El juego fomentaba cooperaciÃ³n.",
    "El deporte unÃ­a a la comunidad.",
    "La danza expresaba emociones.",
    "El cuerpo comunicaba ideas.",
    "La actividad fÃ­sica era cultura.",
    "El deporte educaba valores.",
    "El respeto era esencial.",
    "El movimiento era aprendizaje.",
    "El juego era educativo.",
    "La expresiÃ³n corporal era clave.",
    "El deporte formaba personas."
  ],

  "SudÃ¡frica": [
    "El deporte ayuda a la inclusiÃ³n social.",
    "El rugby es muy importante.",
    "El deporte fomenta igualdad.",
    "El movimiento une culturas.",
    "El juego promueve respeto.",
    "La EF desarrolla valores.",
    "El deporte enseÃ±a cooperaciÃ³n.",
    "El cuerpo expresa identidad.",
    "El juego mejora habilidades sociales.",
    "El deporte fomenta resiliencia.",
    "La actividad fÃ­sica mejora la salud.",
    "El deporte educa convivencia.",
    "El trabajo en equipo es clave.",
    "El movimiento desarrolla autoestima.",
    "El deporte une personas.",
    "El juego es educativo.",
    "El esfuerzo es valorado.",
    "El deporte fomenta la paz.",
    "La actividad fÃ­sica es hÃ¡bito.",
    "El deporte forma ciudadanos."
  ],

  "Brasil": [
    "Brasil combina deporte, mÃºsica y movimiento.",
    "El fÃºtbol es identidad nacional.",
    "La capoeira mezcla lucha y danza.",
    "El deporte fomenta la expresiÃ³n corporal.",
    "La actividad fÃ­sica es cultura.",
    "El juego es cooperativo.",
    "El movimiento mejora coordinaciÃ³n.",
    "Las deportistas brasileÃ±as destacan.",
    "El baile expresa emociones.",
    "El deporte une comunidades.",
    "El ritmo es clave en el movimiento.",
    "La EF fomenta creatividad.",
    "El deporte favorece la inclusiÃ³n.",
    "El juego desarrolla habilidades sociales.",
    "La actividad fÃ­sica mejora la salud.",
    "El deporte educa en valores.",
    "El respeto es fundamental.",
    "El cuerpo comunica ideas.",
    "El deporte genera identidad.",
    "El movimiento es aprendizaje."
  ],

  "Argentina": [
    "El fÃºtbol es muy popular.",
    "El deporte es parte de la identidad.",
    "El tango es expresiÃ³n corporal.",
    "El movimiento transmite emociones.",
    "El deporte fomenta cooperaciÃ³n.",
    "La EF desarrolla habilidades motrices.",
    "El juego es social.",
    "El deporte promueve valores.",
    "Las deportistas argentinas destacan.",
    "El esfuerzo es importante.",
    "El deporte une generaciones.",
    "El movimiento mejora la salud.",
    "El juego desarrolla creatividad.",
    "El deporte educa respeto.",
    "La actividad fÃ­sica es hÃ¡bito.",
    "El cuerpo es medio de expresiÃ³n.",
    "El deporte fomenta autoestima.",
    "El trabajo en equipo es clave.",
    "El juego enseÃ±a normas.",
    "El deporte forma personas."
  ],

  "Estados Unidos": [
    "El deporte escolar es muy importante.",
    "El Flag Football es inclusivo.",
    "El deporte fomenta liderazgo.",
    "El trabajo en equipo es clave.",
    "El deporte motiva al alumnado.",
    "La EF desarrolla autonomÃ­a.",
    "El deporte promueve igualdad.",
    "Las ligas escolares son comunes.",
    "El deporte mejora la salud.",
    "El inglÃ©s es lengua del deporte.",
    "El deporte une culturas.",
    "Las deportistas destacan.",
    "El deporte es espectÃ¡culo.",
    "El juego limpio es esencial.",
    "El deporte educa valores.",
    "La cooperaciÃ³n es bÃ¡sica.",
    "El movimiento mejora la atenciÃ³n.",
    "El deporte fomenta esfuerzo.",
    "La actividad fÃ­sica es hÃ¡bito.",
    "El deporte inspira."
  ],

  "MÃ©xico": [
    "El deporte forma parte de la cultura.",
    "El fÃºtbol es muy popular.",
    "Los juegos tradicionales son importantes.",
    "El movimiento fomenta convivencia.",
    "La actividad fÃ­sica mejora la salud.",
    "El deporte educa valores.",
    "El juego desarrolla cooperaciÃ³n.",
    "Las deportistas mexicanas destacan.",
    "El esfuerzo es importante.",
    "El deporte une comunidades.",
    "El movimiento mejora coordinaciÃ³n.",
    "El juego es aprendizaje.",
    "La EF fomenta hÃ¡bitos saludables.",
    "El deporte favorece inclusiÃ³n.",
    "El respeto es clave.",
    "El cuerpo expresa emociones.",
    "El deporte mejora autoestima.",
    "El trabajo en equipo es esencial.",
    "La actividad fÃ­sica es bienestar.",
    "El deporte forma personas."
  ],

  "JapÃ³n": [
    "Las artes marciales educan respeto.",
    "El deporte fomenta disciplina.",
    "El movimiento mejora autocontrol.",
    "El cuerpo y mente se equilibran.",
    "La actividad fÃ­sica es tradiciÃ³n.",
    "El juego enseÃ±a normas.",
    "El deporte promueve esfuerzo.",
    "El respeto es clave.",
    "El movimiento desarrolla coordinaciÃ³n.",
    "El deporte educa valores.",
    "El juego es aprendizaje.",
    "La EF mejora concentraciÃ³n.",
    "El deporte fomenta igualdad.",
    "El cuerpo expresa control.",
    "El movimiento mejora postura.",
    "El deporte desarrolla carÃ¡cter.",
    "El esfuerzo se valora.",
    "La actividad fÃ­sica es salud.",
    "El juego fomenta cooperaciÃ³n.",
    "El deporte educa."
  ],

  "China": [
    "El Tai Chi mejora equilibrio.",
    "El movimiento es salud.",
    "El deporte fomenta disciplina.",
    "El cuerpo y mente trabajan juntos.",
    "La actividad fÃ­sica es tradiciÃ³n.",
    "El juego mejora coordinaciÃ³n.",
    "El deporte educa respeto.",
    "El movimiento mejora concentraciÃ³n.",
    "El cuerpo expresa control.",
    "El deporte fomenta constancia.",
    "El juego desarrolla habilidades.",
    "La EF mejora salud.",
    "El deporte educa valores.",
    "El esfuerzo es importante.",
    "El movimiento es aprendizaje.",
    "El cuerpo comunica calma.",
    "El deporte fomenta bienestar.",
    "La actividad fÃ­sica es hÃ¡bito.",
    "El juego enseÃ±a autocontrol.",
    "El deporte forma personas."
  ],

  "India": [
    "El yoga une cuerpo y mente.",
    "La actividad fÃ­sica es bienestar.",
    "El movimiento mejora concentraciÃ³n.",
    "El deporte fomenta equilibrio.",
    "El cuerpo y mente estÃ¡n unidos.",
    "El juego enseÃ±a disciplina.",
    "El deporte promueve autocontrol.",
    "La EF mejora salud.",
    "El movimiento reduce estrÃ©s.",
    "El juego desarrolla paciencia.",
    "El deporte educa valores.",
    "El respeto es fundamental.",
    "El cuerpo comunica calma.",
    "El deporte fomenta hÃ¡bitos saludables.",
    "El movimiento mejora postura.",
    "El juego es aprendizaje.",
    "El deporte desarrolla coordinaciÃ³n.",
    "La actividad fÃ­sica es cultura.",
    "El cuerpo es expresiÃ³n.",
    "El deporte educa."
  ],

  "Australia": [
    "El deporte al aire libre es habitual.",
    "La actividad fÃ­sica es estilo de vida.",
    "Los deportes acuÃ¡ticos destacan.",
    "El movimiento mejora la salud.",
    "El juego fomenta cooperaciÃ³n.",
    "El deporte promueve igualdad.",
    "El cuerpo se mueve en la naturaleza.",
    "La EF fomenta hÃ¡bitos activos.",
    "El deporte educa respeto.",
    "El juego desarrolla habilidades.",
    "El movimiento mejora coordinaciÃ³n.",
    "El deporte fomenta bienestar.",
    "La actividad fÃ­sica reduce estrÃ©s.",
    "El cuerpo expresa libertad.",
    "El juego es aprendizaje.",
    "El deporte educa valores.",
    "El esfuerzo es importante.",
    "La actividad fÃ­sica es diaria.",
    "El deporte une personas.",
    "El movimiento educa."
  ],

  "Rusia": [
    "El deporte tiene tradiciÃ³n histÃ³rica.",
    "El atletismo es muy practicado.",
    "El deporte fomenta disciplina.",
    "El movimiento desarrolla resistencia.",
    "El cuerpo trabaja fuerza y control.",
    "El juego fomenta cooperaciÃ³n.",
    "La EF mejora condiciÃ³n fÃ­sica.",
    "El deporte educa esfuerzo.",
    "El movimiento mejora salud.",
    "El deporte promueve constancia.",
    "El cuerpo desarrolla potencia.",
    "El juego enseÃ±a normas.",
    "El deporte fomenta superaciÃ³n.",
    "La actividad fÃ­sica mejora bienestar.",
    "El respeto es importante.",
    "El movimiento desarrolla carÃ¡cter.",
    "El deporte educa valores.",
    "El esfuerzo es clave.",
    "La actividad fÃ­sica es hÃ¡bito.",
    "El deporte forma personas."
  ]
};

const countryIndex = {};

/* =========================
   3. RUTA AZUL
========================= */
const routeCoords = routeData.map(p => p.coords);

// ğŸ”µ Ruta completa del viaje
const routeLine = L.polyline(routeCoords, {
  color: "blue",
  weight: 4
}).addTo(map);

// ğŸ”´ LÃ­nea roja: SOLO lo recorrido
const progressLine = L.polyline([], {
  color: "red",
  weight: 5
}).addTo(map);


/* =========================
   4. CHINCHETAS DE PAÃSES
========================= */
routeData.forEach(p => {
  L.marker(p.coords).addTo(map).bindTooltip(
    `<strong>Etapa ${p.etapa}</strong><br>${p.pais}<br>${p.km} km`,
    { permanent:false, direction:"top" }
  );
});

/* =========================
   5. ICONO DE LA CLASE
========================= */
const schoolIcon = L.divIcon({
  className: "school-icon",
  html: "ğŸƒâ€â™‚ï¸ EducaciÃ³n FÃ­sica con 6Âº"
});

const schoolMarker = L.marker(routeCoords[0], {
  icon: schoolIcon
}).addTo(map);


/* =========================
   6. MOVIMIENTO POR KM
========================= */
const TOTAL_KM = 5000;

function moverIcono(kmActual) {

  let kmRestantes = kmActual;
  let redPoints = [];
  let paisActual = null;
  let puntoActual = routeCoords[0];

  for (let i = 0; i < routeData.length - 1; i++) {

    const actual = routeData[i];
    const siguiente = routeData[i + 1];

    if (kmRestantes > actual.km) {
      // PaÃ­s completado
      redPoints.push(actual.coords);
      kmRestantes -= actual.km;
    } else {
      // Dentro de este paÃ­s
      const t = kmRestantes / actual.km;

      const lat =
        actual.coords[0] +
        (siguiente.coords[0] - actual.coords[0]) * t;

      const lng =
        actual.coords[1] +
        (siguiente.coords[1] - actual.coords[1]) * t;

      puntoActual = [lat, lng];
      redPoints.push(actual.coords, puntoActual);
      paisActual = actual.pais;
      break;
    }
  }

  // ğŸ Final exacto â†’ Rusia
  if (kmActual >= TOTAL_KM) {
    const ultimo = routeData[routeData.length - 1];
    puntoActual = ultimo.coords;
    redPoints = [...routeCoords];
    paisActual = ultimo.pais;
  }

  // ğŸ”„ Actualizar mapa
  schoolMarker.setLatLng(puntoActual);
  progressLine.setLatLngs(redPoints);

  // ğŸŒ Actualizar paÃ­s visible
  document.getElementById("paisActual").innerText =
    "PaÃ­s actual: " + paisActual;

  // ğŸ¥ POP-UP solo si cambia el paÃ­s
  if (paisActualMostrado !== paisActual) {
    paisActualMostrado = paisActual;
    mostrarNotificacion(paisActual, puntoActual);
  }

  // ğŸ“¢ Dato nuevo SIEMPRE
  mostrarDatoPais(paisActual);
}

/* =========================
   7. POPUPS, DATOS Y VÃDEOS
========================= */

let paisActualMostrado = null;
const videoMostrado = {};

// ğŸ¥ VÃ­deos por paÃ­s
// ğŸ‘‰ EspaÃ±a usa ENLACE con minuto (no iframe)
// ğŸ‘‰ El resto se completarÃ¡ mÃ¡s adelante
const videosPlex = {
  "EspaÃ±a": {
    url: "https://youtu.be/XME0oCcZg7w?t=85",
    texto: "Pon el vÃ­deo desde el minuto 1:25"
  }
};

/* =========================
   POPUP CON VÃDEO / MENSAJE
========================= */
function mostrarNotificacion(pais, coords) {
  if (!countryContent[pais]) return;
  if (videoMostrado[pais]) return;

  let contenido = `<strong>${pais}</strong><br><br>`;

  // ğŸ‡ªğŸ‡¸ CASO ESPECIAL: ESPAÃ‘A
  if (pais === "EspaÃ±a") {
    contenido += `
      ğŸ¬ <strong>VÃ­deo: Yo soy Plex</strong><br>
      <span style="color:#1a237e;font-weight:bold;">
        ${videosPlex["EspaÃ±a"].texto}
      </span><br><br>

      <a href="${videosPlex["EspaÃ±a"].url}"
         target="_blank"
         style="
           display:inline-block;
           padding:6px 12px;
           background:#1a237e;
           color:white;
           text-decoration:none;
           border-radius:6px;
           font-weight:bold;
         ">
        â–¶ Ver vÃ­deo en YouTube
      </a>
    `;
  }
  // ğŸŒ RESTO DE PAÃSES (mensaje provisional)
  else {
    contenido += `
      ğŸ“Œ Seguimos avanzando por el mundo con Plex.
      <br><br>
      Pronto descubriremos un vÃ­deo sobre este paÃ­s.
    `;
  }

  L.popup()
    .setLatLng(coords)
    .setContent(contenido)
    .openOn(map);

  videoMostrado[pais] = true;
}

/* =========================
   DATOS DEL PAÃS (SIEMPRE)
========================= */
function mostrarDatoPais(pais) {
  if (!countryContent[pais]) return;

  if (countryIndex[pais] === undefined) {
    countryIndex[pais] = 0;
  }

  const datos = countryContent[pais];
  const i = countryIndex[pais];

  document.getElementById("datoPais").innerText =
    datos[i % datos.length];

  countryIndex[pais]++;
}

/* =========================
   8. EVENTO CONTADOR
========================= */
const actualizarBtn = document.getElementById("actualizarBtn");

actualizarBtn.addEventListener("click", () => {
  const km = Math.min(parseInt(kmInput.value) || 0, TOTAL_KM);
  moverIcono(km);
});
</script>

</body>
</html>
